<!DOCTYPE html>
<html>
<head>
  <title>Admin Panel</title>
  <style>
    body { font-family: Arial; background:#111; color:#fff; padding:20px }
    table { width:100%; border-collapse:collapse }
    th,td { border:1px solid #555; padding:8px; text-align:center }
    button { padding:5px 10px; cursor:pointer }
  </style>
</head>
<body>

<h2>üîê Admin Login</h2>
<input type="password" id="key" placeholder="Enter Admin Key">
<button onclick="login()">Login</button>

<div id="panel" style="display:none">
  <h2>üì¶ Deposit / Withdraw Requests</h2>
  <table>
    <thead>
      <tr>
        <th>User</th>
        <th>Type</th>
        <th>Amount</th>
        <th>Ref ID</th>
        <th>Status</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody id="list"></tbody>
  </table>
</div>

<script>
const ADMIN_KEY = "ADMIN123";

function login() {
  if (document.getElementById("key").value === ADMIN_KEY) {
    document.getElementById("panel").style.display = "block";
    loadRequests();
  } else alert("Wrong Key");
}

function loadRequests() {
  const reqs = JSON.parse(localStorage.getItem("requests")) || [];
  const users = JSON.parse(localStorage.getItem("users")) || [];
  let html = "";

  reqs.forEach((r,i)=>{
    html += `<tr>
      <td>${r.userId}</td>
      <td>${r.type}</td>
      <td>‚Çπ${r.amount}</td>
      <td>${r.refId}</td>
      <td>${r.status}</td>
      <td>
        ${r.status==="PENDING"
        ? `<button onclick="approve(${i})">Approve</button>
           <button onclick="reject(${i})">Reject</button>`
        : "-"}
      </td>
    </tr>`;
  });

  document.getElementById("list").innerHTML = html;
}

function approve(i) {
  const reqs = JSON.parse(localStorage.getItem("requests"));
  const users = JSON.parse(localStorage.getItem("users"));
  const r = reqs[i];

  const user = users.find(u=>u.id===r.userId);
  if (!user) return alert("User not found");

  if (r.type === "DEPOSIT") user.balance += r.amount;
  if (r.type === "WITHDRAW") user.balance -= r.amount;

  r.status = "APPROVED";

  localStorage.setItem("users", JSON.stringify(users));
  localStorage.setItem("requests", JSON.stringify(reqs));
  loadRequests();
}

function reject(i) {
  const reqs = JSON.parse(localStorage.getItem("requests"));
  reqs[i].status = "REJECTED";
  localStorage.setItem("requests", JSON.stringify(reqs));
  loadRequests();
}
</script>

</body>
</html>

